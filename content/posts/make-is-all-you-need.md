---
title: "Make Is All You Need"
date: 2019-12-30T18:03:52-08:00
draft: true
---

As a data analyst mostly working with high level languages and GUI tools,
I thought of [GNU Make](https://www.gnu.org/software/make/) as a tool
(from 1976!) for building Linux binaries from compiled languages like C,
and it didn't occur to me how it could be useful in my workflow.

Today, I use make for all of my software and data science projects, and I
consider it the most important tool for reproducibility. Plus it's
language-agnostic so it's perfect for teams where different people use
R, Python, or other languages for their analysis code.

The [GNU Make Manual](https://www.gnu.org/software/make/manual/make.html)
is quite approachable while also providing great detail, but in a nutshell,
you create a file called `Makefile` in your project directory and add to it
a set of "rules" for producing output files from input files, in this form:

```make
target : prerequisites
    recipe
```

Data analysis code typically involves five steps for processing data:

1. Getting it
2. Cleaning it
3. Exploring it
4. Modeling it
5. Interpreting it

Without a disciplined approach, a typical R or Python script or notebook file
will do all of these steps together, perhaps interleaved, making it difficult
to pull apart these steps apart so that they can be executed separately.

Why is it important to separate them? Some steps may process large quantities of
data, so you don't want to re-run everything each time you change your script.
Caching intermediate results saves you a lot of time as you're developing.

Also, if you want to visualize your data with
[ggplot2](https://ggplot2.tidyverse.org/) before training a predictive model
with [Keras](https://keras.io/),
it's easiest to separate these steps into
different scripts in different languages, rather than doing something
complicated like spawning a Python subprocess from within R or vice versa.

Here's an example of what a Makefile might look like, for generating a paper
written in LaTeX, containing two plots generated by an R script and a Python
script, from a CSV file created by a SQL database query:

```make
default : paper.pdf

paper.pdf : paper.tex figure-01.png figure-02.png
    pdflatex paper.tex

figure-01.png : plot.R data.csv
    Rscript plot.R

figure-02.png : plot.py data.csv
    python plot.py

data.csv: query.sql
    sql2csv --db "sqlite:///database.db" query.sql
```

